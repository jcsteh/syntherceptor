# # Syntherceptor
# SConscript for architecture-specific building of the source
# Copyright 2025 James Teh
# License: GNU General Public License version 2.0

Import("env")

env["nvdaController"] = nvdaController = "#deps/nvdaControllerClient/$shortArch"
env.Append(
	CPPPATH=[nvdaController],
	LIBPATH=[nvdaController]
)
env["CC"] = "clang-cl"
env["LINK"] = "lld-link"
env.Append(CXXFLAGS="/clang:-std=c++20")
# We always want debug symbols.
env.Append(PDB="${TARGET}.pdb")
# having symbols usually turns this off, but we have no need for unused symbols.
env.Append(LINKFLAGS='/OPT:REF')
env.Append(CPPDEFINES=["UNICODE"])
env.SharedLibrary(
	target="syntherceptor",
	source=["classFactory.cpp", "syntherceptor.cpp", "syntherceptor.def"],
	LIBS=["nvdaControllerClient"],
)
